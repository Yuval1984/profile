<mat-toolbar class="toolbar">
  <div class="toolbar-content">
    <!-- Left Side - Stats Display -->
    <div class="toolbar-left">
      <div class="stats-container">
        <div 
          class="stats-display" 
          *ngIf="stats && stats.days && stats.days.length > 0 && stats.days[0].totalVisits > 0"
          (click)="toggleDeviceTypes()"
          [@slideInSineWave]
        >
          <mat-icon class="stats-icon">visibility</mat-icon>
          <span class="stats-text">{{ stats.days[0].totalVisits }}</span>
        </div>
        <div class="device-types-container" *ngIf="showDeviceTypes && getDeviceTypes()" [class.folding-out]="isFoldingOut">
          <button class="device-type-btn device-mobile" *ngIf="getDeviceTypes()?.mobile !== undefined">
            <span class="device-label">Mobile</span>
            <span class="device-count">{{ getDeviceTypes()?.mobile || 0 }}</span>
          </button>
          <button class="device-type-btn device-pc" *ngIf="getDeviceTypes()?.pc !== undefined">
            <span class="device-label">PC</span>
            <span class="device-count">{{ getDeviceTypes()?.pc || 0 }}</span>
          </button>
          <button class="device-type-btn device-tablet" *ngIf="getDeviceTypes()?.tablet !== undefined">
            <span class="device-label">Tablet</span>
            <span class="device-count">{{ getDeviceTypes()?.tablet || 0 }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Center - Navigation Buttons -->
    <div class="nav-buttons">
      <button
        mat-button
        (click)="scrollToSection('profile')"
        class="nav-button nav-profile"
        [class.active]="sectionState.profile.active"
      >
        <mat-icon>person</mat-icon>
        Profile
      </button>
      <button
        mat-button
        (click)="scrollToSection('skills')"
        class="nav-button nav-skills"
        [class.active]="sectionState.skills.active"
      >
        <mat-icon>code</mat-icon>
        Tech Skills
      </button>
      <button
        mat-button
        (click)="scrollToSection('experience')"
        class="nav-button nav-experience"
        [class.active]="sectionState.experience.active"
      >
        <mat-icon>work</mat-icon>
        Experience
      </button>
      <button
        mat-button
        (click)="scrollToSection('gallery')"
        class="nav-button nav-gallery"
        [class.active]="sectionState.gallery!.active"
      >
        <mat-icon>photo_library</mat-icon>
        Portfolio
      </button>
      <button mat-button (click)="openContactDialog()" class="nav-button nav-contact contact-button">
        <mat-icon>contact_mail</mat-icon>
        Contact Me
      </button>
      <mat-menu #projectsMenu="matMenu">
        <button mat-menu-item>
          <mat-icon>rocket_launch</mat-icon>
          <span>Project 1</span>
        </button>
        <button mat-menu-item>
          <mat-icon>rocket_launch</mat-icon>
          <span>Project 2</span>
        </button>
        <button mat-menu-item>
          <mat-icon>rocket_launch</mat-icon>
          <span>Project 3</span>
        </button>
        <button mat-menu-item>
          <mat-icon>rocket_launch</mat-icon>
          <span>Project 4</span>
        </button>
      </mat-menu>
    </div>
  </div>
  <div class="scroll-progress-container">
    <div class="scroll-progress-bar" [style.width.%]="scrollProgress"></div>
  </div>
</mat-toolbar>

<!-- Floating Contact Button for Mobile -->
<div class="floating-contact-btn" (click)="openContactDialog($event)">
  <mat-icon>contact_mail</mat-icon>
  <span>Contact Me</span>
</div>

<!-- Floating Stats Badge for Mobile -->
<div class="floating-stats-container" *ngIf="stats && stats.days && stats.days.length > 0 && stats.days[0].totalVisits > 0">
  <div class="floating-stats-badge" (click)="toggleDeviceTypes()" [@slideInSineWave]>
    <mat-icon>visibility</mat-icon>
    <span>{{ stats.days[0].totalVisits }}</span>
  </div>
  <div class="floating-device-types-container" *ngIf="showDeviceTypes && getDeviceTypes()" [class.folding-out]="isFoldingOut">
    <button class="device-type-btn device-mobile" *ngIf="getDeviceTypes()?.mobile !== undefined">
      <span class="device-label">Mobile</span>
      <span class="device-count">{{ getDeviceTypes()?.mobile || 0 }}</span>
    </button>
    <button class="device-type-btn device-pc" *ngIf="getDeviceTypes()?.pc !== undefined">
      <span class="device-label">PC</span>
      <span class="device-count">{{ getDeviceTypes()?.pc || 0 }}</span>
    </button>
    <button class="device-type-btn device-tablet" *ngIf="getDeviceTypes()?.tablet !== undefined">
      <span class="device-label">Tablet</span>
      <span class="device-count">{{ getDeviceTypes()?.tablet || 0 }}</span>
    </button>
  </div>
</div>

<main class="main-content">
  <!-- Profile Section -->
  <section class="section profile-section" id="profile">
    <div class="profile-container">
      <div class="profile-content">
        <div class="left-content">
          <h1
            [@slideInLeft]="{
              value: sectionState.profile.visible ? 'visible' : 'hidden',
              params: { delay: '0ms' }
            }"
          >
            {{ profile.name }}
          </h1>
          <h2
            [@slideInLeft]="{
              value: sectionState.profile.visible ? 'visible' : 'hidden',
              params: { delay: '800ms' }
            }"
          >
            {{ profile.title }}
          </h2>
          <h3
            [@slideInLeft]="{
              value: sectionState.profile.visible ? 'visible' : 'hidden',
              params: { delay: '1600ms' }
            }"
          >
            {{ profile.education }}
          </h3>
        </div>
        <div class="right-content">
          <div
            class="profile-image-container"
            [@scaleInFade]="{
              value:
                sectionState.profile.visible
                  ? 'visible'
                  : 'hidden',
              params: { delay: '400ms' }
            }"
          >
            <img [src]="profile.image" alt="Profile" class="profile-image" />
          </div>
          <div class="profile-description-container">
            <p
              *ngFor="let paragraph of profile.description; let i = index"
              class="profile-description"
              [@fadeInUp]="profileDescriptionVisible[i] ? 'visible' : 'hidden'"
            >
              {{ paragraph }}
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Skills Section -->
  <section class="section skills-section" id="skills">
    <div class="content-container">
      <h2 class="section-title" [@fadeInUp]="sectionState.skills.visible ? 'visible' : 'hidden'">
        My Skills
      </h2>
      <div class="skills-container">
        <div 
          class="skills-tape-wrapper"
          (mouseenter)="onSkillsTapeMouseEnter()"
          (mouseleave)="onSkillsTapeMouseLeave()"
          [class.paused]="isSkillsTapePaused"
        >
          <div class="skills-tape">
            <ng-container *ngFor="let skill of getSkillsForTape(); let i = index">
              <div
                class="skill-item"
                (click)="showSkillDescription(i % skills.length)"
                (mouseenter)="onSkillItemHover(i % skills.length)"
                (mouseleave)="onSkillItemLeave()"
              >
                <img [src]="skill.icon" [alt]="skill.name" class="skill-icon" />
                <span class="skill-name">{{ skill.name }}</span>
              </div>
            </ng-container>
          </div>
        </div>
        <div class="skills-description-container">
          <p
            *ngFor="let skillDescription of skillDescriptions"
            class="skills-description"
            [class.active]="skillDescription.active"
          >
            {{ skillDescription.description }}
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Experience Section -->
  <section class="section experience-section" id="experience">
    <div class="content-container">
      <h2
        class="section-title"
        [@fadeInUp]="
          sectionState.experience.visible && !sectionState.experience.hasAnimated
            ? 'visible'
            : 'hidden'
        "
      >
        Experience
      </h2>
      <div class="experience-timeline">
        <mat-card
          class="experience-card"
          *ngFor="let exp of experiences; let even = even; let i = index"
          [@experienceAnimation]="{
            value: exp.isVisible ? 'visible' : 'hidden',
            params: { startX: even ? '80px' : '-80px' }
          }"
          [style.--card-color]="even ? '#FF6B6B' : '#4ECDC4'"
          [attr.data-index]="i"
        >
          <mat-card-header [class.even]="even">
            <mat-card-title-group>
              <mat-card-title
                [@typewriter]="{
                  value:
                    sectionState.experience.visible && !sectionState.experience.hasAnimated
                      ? 'visible'
                      : 'hidden',
                  params: { duration: 1000 }
                }"
              >
                {{ exp.role }}
              </mat-card-title>
              <mat-card-subtitle>
                <div
                  class="company-info"
                  [@fadeInUp]="
                    sectionState.experience.visible && !sectionState.experience.hasAnimated
                      ? 'visible'
                      : 'hidden'
                  "
                >
                  <span class="company-name">{{ exp.company }}</span>
                  <mat-chip-set>
                    <mat-chip [style.background-color]="even ? '#FF6B6B' : '#4ECDC4'" highlighted>
                      {{ exp.years }}
                    </mat-chip>
                  </mat-chip-set>
                </div>
              </mat-card-subtitle>
            </mat-card-title-group>
          </mat-card-header>
          <mat-card-content>
            <mat-divider></mat-divider>
            <div class="experience-content">
              <div class="exp-details">
                <ul>
                  <li
                    *ngFor="let detail of exp.details; let j = index"
                    [@fadeInUp]="getDetailVisibility(i, j) ? 'visible' : 'hidden'"
                  >
                    <mat-icon [style.color]="even ? '#FF6B6B' : '#4ECDC4'">check_circle</mat-icon>
                    <span>{{ detail }}</span>
                  </li>
                </ul>
              </div>
              <div class="tech-chart-container">
                <h4>Tech Stack Distribution</h4>
                <canvas #techChart class="tech-chart"></canvas>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </section>
  <section class="section gallery-section" id="gallery">
    <div class="content-container">
      <h2 class="section-title" [@fadeInUp]="sectionState.gallery!.visible ? 'visible' : 'hidden'">
        Portfolio Gallery
      </h2>
      <div class="gallery-container">
        <div
          class="gallery-row"
          *ngFor="let item of galleryItems; let i = index"
          [@portfolioAnimation]="{
            value: sectionState.gallery!.visible ? 'visible' : 'hidden',
            params: {
              delay: i * 200 + 'ms',
              startX: i % 2 === 0 ? '-100%' : '100%'
            }
          }"
          [class.row-reverse]="i % 2 === 0"
        >
          <div class="gallery-content">
            <h3>{{ item.title }}</h3>
            <p>{{ item.description }}</p>
          </div>
          <div class="gallery-image">
            <img [src]="item.image" [alt]="item.title" loading="lazy" decoding="async" />
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
